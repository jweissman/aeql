(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),c=n(38),l=n.n(c),u=(n(47),n(48),n(8)),o=n(6),s=n.n(o),m=n(10),d=n(3),h=n(4),f=n(15),p=n(14),b=n(16),v=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},E=(n(50),function(e){var t=e.models;return t.length?i.a.createElement("section",{className:"EntityTable"},i.a.createElement("table",null,i.a.createElement("thead",null,i.a.createElement("tr",null,Object.entries(t[0]).map(function(e){var t=Object(u.a)(e,2),n=t[0];t[1];return i.a.createElement("th",{key:n},v(n))}))),i.a.createElement("tbody",null,t.map(function(e){return i.a.createElement("tr",{key:e.id},i.a.createElement(i.a.Fragment,null,Object.entries(e).map(function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return i.a.createElement("td",{key:n},a instanceof Object?"[object]":a)})))})))):i.a.createElement("p",null,"Nothing.")}),y=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(f.a)(this,Object(p.a)(t).call(this,e))).textarea=void 0,n.intervalID=0,n.lastValue="nothing",n.polling=!1,n.textarea=i.a.createRef(),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.intervalID=window.setInterval(function(){if(e.lastValue&&e.lastValue!=e.textarea.current.value&&!e.polling){var t=e.textarea.current.value;e.props.parseAeql(t),e.lastValue=t}},150)}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalID)}},{key:"render",value:function(){var e=this.props.resultData;return i.a.createElement(i.a.Fragment,null,i.a.createElement("label",null,"ask aeql anything: \xa0",i.a.createElement("textarea",{id:"query",ref:this.textarea,defaultValue:this.props.initialQuery||"find humans"})),this.props.errors&&i.a.createElement("section",{style:{minWidth:"100%"}},i.a.createElement("div",{style:{textAlign:"justify",whiteSpace:"pre-wrap"}},this.props.errors.split("\n").map(function(e){return i.a.createElement("p",{key:e},i.a.createElement("code",null,e))}))),i.a.createElement("section",{className:"Result",style:{backgroundColor:"#eaeaea"}},i.a.createElement("h3",null,this.props.result),e instanceof Object&&i.a.createElement(E,{models:e})))}}]),t}(i.a.Component),g=n(9),O=n.n(g),j=n(39);if(n.n(j).a){var w=n(105).readFileSync("./src/Aeql/Aeql.ohm");a=O.a.grammar(w)}else a=O.a.grammarFromScriptElement();var k=a,N=n(23),A=function(){function e(t){Object(d.a)(this,e),this.value=t}return Object(h.a)(e,[{key:"describe",value:function(){return this.value}},{key:"getValue",value:function(){return this.value}}]),e}(),x=function(){function e(t){Object(d.a)(this,e),this.name=t}return Object(h.a)(e,[{key:"describe",value:function(){return"".concat(this.name.describe())}},{key:"getName",value:function(){return this.name.getValue()}}]),e}(),I=function(){function e(t,n){Object(d.a)(this,e),this.attributeName=t,this.attributeExpr=n}return Object(h.a)(e,[{key:"getAttributeName",value:function(){return this.attributeName.getValue()}},{key:"getValue",value:function(){return this.attributeExpr.getValue()}}]),Object(h.a)(e,[{key:"describe",value:function(){return"".concat(this.attributeName.describe()," is ").concat(this.attributeExpr.describe())}}]),e}(),S=function(){function e(t){Object(d.a)(this,e),this.name=t}return Object(h.a)(e,[{key:"describe",value:function(){return"".concat(this.name.describe())}},{key:"getName",value:function(){return this.name.getValue()}}]),e}(),C=function e(t){Object(d.a)(this,e),this.url=t},q=function(){function e(t){Object(d.a)(this,e),this.vehicle=t}return Object(h.a)(e,[{key:"describe",value:function(){return"".concat(this.vehicle.url)}},{key:"getUrl",value:function(){return this.vehicle.url}}]),e}(),D=function(){function e(t,n,a,r){Object(d.a)(this,e),this.subject=t,this.order=n,this.conditions=a,this.via=r}return Object(h.a)(e,[{key:"describe",value:function(){console.log("conditions",this.conditions);var e="";this.conditions&&this.conditions.length&&(e="where ".concat(this.conditions.map(function(e){return e.describe()})));var t="";this.order&&(t="by ".concat(this.order.describe()));var n="";return this.via&&(n="via ".concat(this.via.describe())),"Find ".concat(this.subject.describe()," ").concat(t," ").concat(e," ").concat(n)}}]),e}(),V={Query:function(e,t,n){var a=t.tree(),r=n.tree(),i=void 0,c=void 0,l=[];return r instanceof Array&&r.forEach(function(e){if(e instanceof S){if(i)throw new Error("Can't have multiple orderings");i=e}else if(e instanceof q){if(c)throw new Error("Can't have multiple vehicles (vias)");c=e}else e instanceof Array&&e.length&&e[0]instanceof I&&(l=e)}),new D(a,i,l,c)},Entity:function(e){return new x(e.tree())},Criteria:function(e,t){return console.log("CRITERIA",t.tree()),t.tree()},Conditions:function(e){return e.tree()},Condition:function(e,t,n){return console.log("CONDITION",{attrTree:e.tree(),valTree:n.tree()}),new I(e.tree(),n.tree())},Order:function(e,t){var n=t.tree();return new S(n)},Via:function(e,t){return new q(t.tree())},Vehicle:function(e,t){return new C("/"+t.tree())},URL:function(e){return e.sourceString},EmptyListOf:function(){return[]},emptyListOf:function(){return[]},NonemptyListOf:function(e,t,n){return[e.tree()].concat(Object(N.a)(n.tree()))},nonemptyListOf:function(e,t,n){return[e.tree()].concat(Object(N.a)(n.tree()))},ident:function(e,t){return new A(e.sourceString+t.sourceString)}},R=k.createSemantics();R.addOperation("tree",V);var L=R,T=n(40),U=n.n(T),F=new(function(){function e(t){Object(d.a)(this,e),this.config=t,this.personae=void 0,this.data=void 0,this.personae=t.personae,t.data&&(this.data=t.data)}return Object(h.a)(e,[{key:"interpret",value:function(e){var t=k.match(e);if(t.succeeded())return L(t).tree();throw new Error("Could not parse input string: "+t.message)}},{key:"evaluate",value:function(){var t=Object(m.a)(s.a.mark(function t(n){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.via&&!this.data){t.next=7;break}return t.next=3,e.processSimpleQueryManually(n,this.data||{});case 3:return a=t.sent,t.abrupt("return",a);case 7:throw new Error("No data provided!");case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"resolve",value:function(){var e=Object(m.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.evaluate(this.interpret(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}],[{key:"processSimpleQueryManually",value:function(){var e=Object(m.a)(s.a.mark(function e(t,n){var a,r,i,c,l;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("PROCESS SIMPLE QUERY MANUALLY",{q:t}),a=v(t.subject.getName()),r=[],!t.via){e.next=10;break}return e.next=6,U.a.get(t.via.getUrl(),{baseURL:"https://jsonplaceholder.typicode.com"});case 6:i=e.sent,r=i.data,e.next=11;break;case 10:n[a]&&n[a].length&&(r=n[a].slice());case 11:return t.order&&(c=t.order,l=c.getName(),r=r.sort(function(e,t){return e[l]>t[l]?1:-1})),t.conditions&&t.conditions.forEach(function(e){var t=e.getAttributeName(),n=e.getValue();r=r.filter(function(e){var a=e[t]==n;return console.log({it:e,matches:a}),!!a}),console.log("APPLY CONDITION",{condition:e,collection:r})}),e.abrupt("return",r);case 14:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}]),e}())({personae:{Human:{name:"string",age:"int"},Employee:{name:"string",empId:"int",age:"int",salary:"int",department:"Department"}},data:{Humans:[{id:1,name:"Zeta",age:59},{id:2,name:"Bob",age:23},{id:3,name:"Jim",age:19},{id:4,name:"Abel",age:24},{id:5,name:"Sawyer",age:34}],Employees:[{id:1,name:"Rhonda",empId:1002,age:47,salary:14e3},{id:2,name:"Barbara-Anniston",empId:1034,age:23,salary:18e3},{id:3,name:"Carol Andrews",empId:1045,age:35,salary:1e4},{id:4,name:"Sandra Amberg",empId:5044,age:42,salary:18500},{id:5,name:"Andra Saunders",empId:231,age:23,salary:8e3},{id:6,name:"Exandra Calabanza",empId:1,age:68,salary:12e3}]}}),M=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(f.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={query:"",errors:"",result:"",resultData:[]},n.parseAeql=function(){var e=Object(m.a)(s.a.mark(function e(t){var a,r,i,c,l;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==(a=t)){e.next=5;break}n.setState({query:"",result:""}),e.next=20;break;case 5:return r="",i=void 0,c=[],e.prev=8,l=F.interpret(a),r=l.describe(),e.next=13,F.evaluate(l);case 13:c=e.sent,e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),i=e.t0.message;case 19:n.setState({query:a,result:r,errors:i,resultData:c});case 20:case"end":return e.stop()}},e,null,[[8,16]])}));return function(t){return e.apply(this,arguments)}}(),n}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("h3",null,"query playground"),i.a.createElement("p",null,"answer all your questions here!"),i.a.createElement("section",{style:{backgroundColor:"#e4eae9"}},i.a.createElement("h3",null,"TIPS"),i.a.createElement("dl",null,i.a.createElement("dt",null,"QUERY FORM"),i.a.createElement("dd",null,"the basic form of a query begins with ",i.a.createElement("code",null,"find...")," or ",i.a.createElement("code",null,"get [model-or-persona-name]")),i.a.createElement("dt",null,"ORDERING"),i.a.createElement("dd",null,"you can order by attributes with ",i.a.createElement("code",null,"by [attribute name]")),i.a.createElement("dt",null,"SELECTION"),i.a.createElement("dd",null,"pick columns like ",i.a.createElement("code",null,"find humans whose age is 100")),i.a.createElement("dt",null,"FETCHING"),i.a.createElement("dd",null,"load data with ",i.a.createElement("code",null,"via https(/users)")))),i.a.createElement("section",null,i.a.createElement(y,{initialQuery:"find users via /users",errors:this.state.errors,parseAeql:this.parseAeql,result:this.state.result,resultData:this.state.resultData})),i.a.createElement("section",{style:{backgroundColor:"#eaeaf3"}},i.a.createElement("b",null,"DATA"),F.data&&Object.entries(F.data).map(function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return i.a.createElement(E,{key:n,collectionName:n,models:a})})),i.a.createElement("section",{className:"SchemaAndDataSet"},i.a.createElement("b",null,"SCHEMA"),Object.entries(F.personae).map(function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return i.a.createElement("section",{className:"persona",key:n},i.a.createElement("h3",null,"Persona ",n),i.a.createElement("ul",null,Object.entries(a).map(function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return i.a.createElement("div",{key:n},n," (",a,")")})))})))}}]),t}(r.Component),Q=function(){return i.a.createElement("span",{className:"Aeql-name",style:{color:"#aeeaea",textShadow:"1.2px 1.2px #aeaeae",fontSize:"135%",fontWeight:"bolder"}},"aeql")},P=function(){return i.a.createElement("div",{className:"App"},i.a.createElement("header",{className:"App-header"},"hello aeql"),i.a.createElement("main",{className:"App-main"},i.a.createElement("section",{className:"Welcome",style:{backgroundColor:"#fafaf3"}},i.a.createElement("h1",null,"let's learn all about ",i.a.createElement(Q,null),"!"),i.a.createElement("p",null,i.a.createElement(Q,null),": it's a tiny query language"),i.a.createElement("pre",null,"find humans by name"),i.a.createElement("p",null,i.a.createElement(Q,null)," emphasizes human values, encouraging the description of personae in the system")),i.a.createElement("section",{className:"QueryManager"},i.a.createElement(M,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},41:function(e,t,n){e.exports=n(123)},47:function(e,t,n){},48:function(e,t,n){},50:function(e,t,n){}},[[41,1,2]]]);
//# sourceMappingURL=main.45a8af99.chunk.js.map